# WIP

## 目标
- 完成“选择剧本 / 建卡 / 进入游戏”的新流程，支持顺序可切换
- 建立 D1 数据结构与 API（脚本 / 人物 / 游戏）
- 保持两列布局 + 侧边栏，主游戏区 100% 高度
- OpenAI / Gemini provider 接入 + 默认模型配置
- 建立前端测试框架并覆盖关键流程

## Todo
- [x] 页面整体两列结构（左侧边栏 + 主游戏区）
- [x] 主游戏区固定 100% 高度，聊天区不分页
- [x] 拆分准备阶段（选择剧本 / 建卡）与游戏主界面
- [x] 示例 COC 剧本（两场景 + 两战斗）
- [x] D1 schema + seed
- [x] 脚本 / 人物 / 游戏 API
- [x] 人物卡保存与开始游戏流程串联
- [x] Vitest + RTL + 基础流程测试
- [x] 默认模型（OpenAI gpt-5-mini / Gemini gemini-3-flash-preview）
- [x] 补充“继续编辑人物卡 / 重新选择剧本”入口
- [x] 人物卡必须基于剧本创建（脚本清单 + scriptId 绑定）
- [x] 数据库改为 migrations 驱动（schema / seed 进入迁移）
- [x] 剧本可配置职业 / 出身 / 状态 / 属性范围
- [x] 人物卡创建读取剧本限定选项
- [x] 文档补充剧本与人物卡约束
- [x] 参考 COC 点购规则补充属性点总预算（脚本字段 + 校验 + UI 展示）
- [x] 新增剧本属性点预算迁移并执行本地迁移
- [x] character-creator 拆分至 400 行以内
- [x] 补充属性点预算相关测试
- [ ] 补充 API 异常与加载状态测试（可选）
- [ ] 检查响应式与信息密度

## 问题与待确认
- 数据库初始化由你执行？是否需要我补一份运行指引到文档
- 场景地图里需要展示的实体类型与密度上限
